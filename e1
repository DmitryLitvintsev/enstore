#!/bin/sh

if [ "${1:-}" = "-x" ] ; then set -xv; shift; fi
set -u  # force better programming and ability to use check for not set

if [ `uname -n | grep -c -i willow` -ne 0 ] ; then
  unset setup
fi

if [ -z "${PYTHON_DIR-}" ] ; then
  echo "Setting up python"
  setup python
  if [ $? -ne 0 ] ; then
    PYTHON_DIR=/usr/local
    export PYTHON_DIR
  fi
fi


if [ -z "${ENSTORE_DIR-}" ] ; then
  echo "Setting up enstore"
  place=`pwd`
  cd ~bakken/enstore`uname`
  setup -r `pwd` enstore
  if [ $? -ne 0 ] ; then
    ENSTORE_DIR=`pwd`
    export ENSTORE_DIR
    . ups/setup.sh
  fi
  cd $place
fi

ENSTORE_CONFIG_FILE=$ENSTORE_DIR/etc/willow.conf
export ENSTORE_CONFIG_FILE

ENSTORE_CONFIG_PORT=7510
export ENSTORE_CONFIG_PORT

ENSTORE_CONFIG_HOST=pcfarm4.fnal.gov
export ENSTORE_CONFIG_HOST

. $ENSTORE_DIR/etc/defaults
