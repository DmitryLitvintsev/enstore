# this file has to be sourced.
# its purpose is to make all necessary setting to run enstore in nonUPS environment

ENSTORE_DIR=`rpm -ql enstore_sa | head -1`
export ENSTORE_DIR
. $ENSTORE_DIR/sbin/ENSTORE_HOME


ENSTORE_DIR=$BASE/enstore; export ENSTORE_DIR
ENSTORE_CONFIG_PORT=7500; export ENSTORE_CONFIG_PORT
PATH=$ENSTORE_DIR/sbin:$ENSTORE_DIR/bin:$PATH
ENSTORE_MAIL=moibenko@tundra.fnal.gov; export ENSTORE_MAIL

CVSROOT=hppccvs@cdcvs.fnal.gov:/cvs/hppc; export CVSROOT
unset CVS_RSH 2>//dev/null;

FTT_DIR=`rpm -ql ftt | head -1`
export FTT_DIR

PYTHON_DIR=`rpm -ql Python-enstore | head -1`;export PYTHON_DIR
PYTHONINC=`ls -d $PYTHON_DIR/include/python*`; export PYTHONINC
PYTHONLIB=`ls -d $PYTHON_DIR/lib/python*`;export PYTHONLIB
PATH=$PYTHON_DIR/bin:$PATH
PYTHONPATH=$ENSTORE_DIR/src:$ENSTORE_DIR/modules:$ENSTORE_DIR/HTMLgen; export PYTHONPATH
PYTHONUNBUFFERED="x"; export PYTHONUNBUFFERED

type postgres
if [ $? eq 0 ];
then
	POSTGRES_DIR=`type postgres | cut -f3 -d" " | sed -e 's/postgres//'`

	if [ "${LD_LIBRARY_PATH:-x}" = "x" ];
	then
		LD_LIBRARY_PATH=$POSTGRES_DIR/lib
	else
		LD_LIBRARY_PATH=$POSTGRES_DIR/lib:$LD_LIBRARY_PATH;
	fi
export POSTGRES_DIR
PATH=$POSTGRES_DIR/bin:$PATH
export LD_LIBRARY_PATH
fi
GADFLY_GRAMMAR=$ENSTORE_DIR/gadfly; export GADFLY_GRAMMAR

if [ ! -r $ENSTORE_DIR/bin/encp ]; then ln -s $ENSTORE_DIR/src/encp.py $ENSTORE_DIR/bin/encp;fi
if [ ! -r $ENSTORE_DIR/bin/enstore ]; then ln -s $ENSTORE_DIR/src/enstore_admin.py $ENSTORE_DIR/bin/enstore; fi

#node=`uname -n| sed -e 's/\([^\.]\)\..*/\1/'`

export ENSTORE_CONFIG_HOST=tundra.fnal.gov
export ENSTORE_CONFIG_FILE=$ENSTORE_DIR/etc/tundra.conf
export ENSTORE_WWW_DIR=/var/www/html/enstore
export FARMLETS_DIR=/usr/local/etc/farmlets
