<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
   <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
   <META NAME="Author" CONTENT="Vicky White">
   <META NAME="GENERATOR" CONTENT="Mozilla/4.06 [en] (X11; I; Linux 2.0.35 i686) [Netscape]">
   <TITLE>Enstore-functional-components</TITLE>
</HEAD>

<H1>Summary of D0 Functional Specifications</h1>

Below is a list of functional specifications on Enstore generated by D0.
For the most part, the product complies in software features. Execptions
are noted. The operational procedures (Section 6)are mostly to be constructed.
<H2>
The Functionality we expect of a Storage Management Layer</H2>
There are 6 major functional areas.&nbsp; They are described in more detail
and broken down further below.
<UL>
<LI>
Cataloging and
Database Functions for Files and Tape Volumes</LI>

<LI>
Specification
and Control of&nbsp; Tape Volume Storage Locations</LI>

<LI>
Control of various
parameters which govern the functional behavior and performance of the
system</LI>

<LI>
Management of
the robot resources (including error recovery and tracking)</LI>

<LI>
Movement of files
between users machine/local disk and tape in robot.</LI>

<LI>
Operational procedures
to run and manage the robot, the data stored in the system, the tape drives,&nbsp;
and the "databases"</LI>
</UL>

<H5>
1) Cataloging and Database Functions</H5>


<H5>
1.1) Maintenance of the primary "database" of file
to tape volume information</H5>

<UL>
<LI>
reliable and backed up
"database" of each&nbsp; volume and file. the volume location of each file,&nbsp;
and the position within each volume for each file</LI>

<p> <b><it> PNFS backup issues will be treated in DESY visit this February </it></b></P>.

<LI>
assurance that all movement
of files/deletion of files is correctly reflected in the "database"</LI>

<LI>
notation of volume/file
status (e.g. if unreadable or errors)</LI>

<LI>
tracking of the tape volume format</LI>
</UL>



<H4>
1.2) Provide access to File namespace
and Volume Information</H4>

<UL>
<LI>
tools for users to easily
and intuitively view all files in the system along with other commonly
needed information about the file - such as owner, 'grouping', date written,
etc.</LI>

<LI>
tools for users to easily
and intuitively view all volumes in the system</LI>

<LI>
tools for viewing file/volume
related information such as all files on a volume</LI>

<LI>
tools for exporting all,&nbsp;
or recently changed parts,&nbsp; of the file and volume database to the
data access layer (for performance reasons) or to remote institutions</LI>
</UL>


<H4>
2) Specification and control of Tape storage locations</H4>

<UL>
<LI>
ability
to handle several distinct robot storage locations</LI>

<LI>
ability
to treat a single physical robot as multiple logical storage locations</LI>

<LI>
ability
to handle various physical&nbsp; 'shelves' as possible storage locations</LI>

<LI>
ability
to migrate tape volumes between storage locations</LI>

<LI>
ability
to import volumes into storage locations (given sufficient meta-data in
an acceptable format)</LI>

<LI>
ability
to export volumes (with their associate meta-data)</LI>

<LI>
possibly
implementation of quota system for particular user/group within a storage
location</LI>
</UL>

<H4>
3) Control of parameters which govern the functional
behavior of the system</H4>


<H5>
3.1) Control of parameters which govern allocation
and use of tape drives</H5>

<UL>
<LI>
possibly specicification of preference
or affinity between certain access modes, users&nbsp; or groups, and certain
subsets or classes of physical tape drives</LI>
</UL>
<p> <b><it> Cannot do this right now, requires hook in Library Manager </it></b></P>.


<H5>
3.2) Control of parameters which govern how files
are written to tape</H5>

<UL>
<LI>
specification of "groupings" or File
Families for files</LI>

<LI>
specification of "width" for a grouping
- ie number of tapes allowed to be written in //</LI>

<LI>
possibly specification of a list of
files to be treated logically as one 'work unit'</LI>

<LI>
specification of&nbsp; "append to tapes"
policy</LI>

<LI>
specification of file wrappering format</LI>

<LI>
associaton of tape volumes to a particular
file family and tape library</LI>
</UL>

<H5>
<B>3.3) Control of parameters which govern how files
are read from tape</B></H5>

<UL>
<LI>
specification of error/retry behavior</LI>
</UL>
<p> <b><it> Cannot do this dynamically, have static retry behavior, and will makr this comply to D0 needs. </it></b></P>.
<H5>
<B>3.4) Control of parameters which govern</B> <B>access
to files and volumes</B></H5>

<UL>
<LI>
access control based on user/group
for each file and each file family</LI>
</UL>

<H5>
<B>3.5) Control of parameters which govern network
routing between storage system movers and client machines</B></H5>

<UL>
<LI>
ability to choose optimal path to load
balance in the case of multiple network interfaces on a single machine</LI>
</UL>

<H5>
<B>3.6) Ability to set defaults for many/most of
the above parameters</B></H5>

<UL>
<LI>
storing of default values to be used
for all transfers/work done for</LI>

<UL>
<LI>
a particular user/group</LI>

<LI>
a particular file family</LI>

<LI>
a particular storage location</LI>

<LI>
? possibly others</LI>
</UL>
</UL>


<H4>
4) Management of the robot resources (including error
recovery and tracking)</H4>

<UL>
<LI>
Maintenance of a queue of work to do
in case of excess demand on the robot or on the tape drives</LI>

<LI>
Ability to specify policies governing
the ordering and manipulation of that queue of work, and therefore the
delay seen by the user, including (but not limited to)</LI>

<UL>
<LI>
specification of a priority for all
work requested</LI>

<LI>
specification of a priority increment
and delta time in order to implement a priority boost/aging algorithm (or
equivalent mechanisms)</LI>

<LI>
specification of&nbsp; policy for dismounting
of tapes after work completed</LI>

<LI>
other possible parameters to be decided
based on tests/tuning of system</LI>
</UL>

<LI>
Cleanup of work queue in case of errors
and cancelled requesting processes</LI>

<LI>
Allocation of tape drives to units
of work in the queue</LI>

<LI>
Retry of errored file reads/writes
up to specified maximum</LI>

<LI>
Repeat attempts at failed work using
alternate tape drive resources</LI>

<LI>
Notation and tracking of all work done,
all errors encountered, all retries performed</LI>
</UL>

<p> <b><it> Does does not track reties in a user-visible way, except that the delay is apparent. </it></b></P>.

<B>5) Movement of Files&nbsp;
between users machine/local disk and tape in robot.</B>
<UL>
<LI>
ability
to transfer files from any network-connected machine to/from tape drive
in robot</LI>

<LI>
ability
to transfer files reliably and with error detection, and correction by
retry</LI>

<LI>
ability
to transfer files at > N% of raw tape bandwidth. N is probably about 50.</LI>

<LI>
nothing
done to exclude the possibility of adding an intermediate disk cache layer
to rate adjust movement of data from tape drive to end user data sink -
should that become necessary</LI>

<LI>
nothing
done to exclude the possibility of cooperation with the data access layer
as a distributed disk cache of recently requested data</LI>
</UL>

<H4>
6) Operational procedures to run and manage the robot,
tape drives and "databases"</H4>


<H5>
6.1) Robot and Tape Drive Hardware</H5>


<UL>
<UL>
<LI>
Well defined and safe procedures for
dealing with repair and maintenance of the robot itself</LI>

<LI>
Procedures for monitoring the status
of&nbsp; tape drives and for replacing faulty drives with drives which
have been checked and tested through another well-defined process.</LI>
</UL>

<H5>
6.2) Operator procedures for import/export of batches
of tapes</H5>

<UL>
<LI>
Interface between Storage Management
system and Operator work/console system</LI>

<LI>
Definition of policies for executing
batch imports/exports of tape volumes</LI>
</UL>

<H5>
6.3) Quality assurance procedures to assure integrity
of the data and metadata</H5>

<UL>
<LI>
Routine backup of "database"</LI>

<LI>
Maintenance of a water-tight redo log
of all transaction to be used in case of errors</LI>

<LI>
Recovery procedures in place, tested
and executed in case of failures</LI>

<LI>
Ability to recover files and data on
tape in case of complete and catastrophic loss of all "databases"</LI>

<LI>
Routine checks on readability of sample
of tapes - maintenance of statistics</LI>
</UL>
</UL>

</BODY>
</HTML>
