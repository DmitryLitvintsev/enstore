#!/usr/bin/env python

# $Id$

KB=1024L
MB=KB*KB
GB=KB*MB
TB=KB*GB
PB=KB*TB
EB=KB*PB

dlt_rate =     5.1 * MB
lto3_rate =   60.0 * MB
lto4_rate =   70.0 * MB
null_rate =   11.5 * MB
s9940b_rate = 27.0 * MB
lto5_rate =   140.0 * MB

legal_encp_version = 'v3_6c'

update_interval_in_bound = 2

lto3_min_buffer = 64*MB
lto3_max_buffer = 2500*MB
lto3_mvr_check_f = 300
lto3_mvr_check_1st = 0
lto3_dismount_delay = 30

mvr_check_f = 100
mvr_check_1st = 0

mvr_max_failures=5
mvr_max_consecutive_failures=3
max_buf=2500*MB
min_buffer = 64*MB
vol_max_noaccess_cnt=4
blank_error_increment = 0

low_level_diag_pattern = 'st[0-9]' # pattern to look in syslog file when FTT_EIO occurs
lto3_min_buffer = 64*MB
lto3_max_buffer = 2500*MB
lto3_mvr_check_f = 10
lto3_mvr_check_1st = 0

lto4_min_buffer = 64*MB
lto4_max_buffer = 2500*MB
lto4_mvr_check_f = 1000
lto4_mvr_check_1st = 0

lto5_min_buffer = 64*MB
lto5_max_buffer = 4500*MB
lto5_mvr_check_f = 600
lto5_mvr_check_1st = 0
lto5_dismount_delay = 30
lto5_update_interval = 2

crc_seed = 0

monitoring_and_web="dmsen02.fnal.gov"
enstore_DB="dmsen05.fnal.gov"
enstore_backup="dmsen03.fnal.gov"
enstore_library="pmig01.fnal.gov"
enstore_pnfs="dmsen06.fnal.gov"
enstore_DB_host=enstore_DB
backup_host=enstore_backup
verify_host=enstore_backup
monitoring_host=monitoring_and_web
web_server_host=monitoring_and_web
log_server_host=monitoring_and_web
alarm_server_host=monitoring_and_web
ratekeeper_host=monitoring_and_web
event_relay_host=monitoring_and_web
#inquisitor_host=enstore_backup
inquisitor_host=monitoring_and_web
DB_host=enstore_DB_host
file_clerk_host=enstore_DB_host
volume_clerk_host=enstore_DB_host
info_server_host=enstore_DB_host
accounting_server_host=enstore_DB_host
drivestat_server_host=enstore_DB_host
media_changer_host="dmsen02.fnal.gov"
library_manager_host=enstore_library
#enstore_qpid_broker_host="dmsen03.fnal.gov"
enstore_qpid_broker_host="pmig01.fnal.gov"

#Post SDE values.
html_dir = "/srv2/enstore_cache/www/web-pages/"
log_dir = "/srv2/enstore_cache/enstore-log"
backup_dir =  "/srv3/enstore_cache/backups"
inventory_dir =	"/srv2/enstore_cache/db-inventory"
httpd_dir = "/srv2/enstore_cache/www/file_aggr" # leave as in PRE SDE
httpd_dir2 =httpd_dir # leave as in PRE SDE 
ratekeeper_dir = "/srv2/enstore_cache/ratekeeper/"
db_basedir = "/srv1/enstore/databases1"
write_cache_area='/data/cache/data'
#write_cache_area='/data1/cache/data'
stage_area='/data/stage'
#stage_area='/data1/stage'
tmp_stage_area='%s/tmp_stage'%(stage_area,)
archive_area='/data/archive'

www_alias = "www-fileaggr"   # this must be optional
pnfs_alias = "pnfs-fileaggr" # this must be optional
configdict = {}

#This is Fermilab specific.
configdict['service_ips'] = {
    www_alias  : {'host' : monitoring_and_web, 'interface' : "www"},
    pnfs_alias : {'host' : enstore_pnfs, 'interface' : "pnfs"},
    }

configdict['encp']={'crc_seed' : crc_seed }

configdict['known_config_servers'] = {'aggren' : (monitoring_and_web, 7500),
				      }

configdict['system'] = { 'allowed_down' : {'log_server' :           [1, 10],
					   'alarm_server' :         [1, 10],
					   'configuration_server' : [1, 10],
					   'file_clerk' :           [1, 10],
					   'inquisitor' :           [3, 30],
					   'volume_clerk' :         [1, 10],
                                             'pnfs_agent' :         [1,10],
					   'library_manager' :      [2, 20],
					   'accounting_server' :    [3, 20],
					   'drivestat_server' :     [3, 20],
					   'info_server' :          [3, 20],
					   'media_changer' :        [2, 10],
					   'default' :              [1, 20] }}


configdict['pnfs_server'] = {'host':enstore_pnfs,}

configdict['namespace']    = {
    'file_aggr' : {'dbname' : 'chimera',
             'dbhost' : 'dmsen01',
             'dbport' : 5432,
             'dbuser' : 'enstore' },
    }



configdict['priority'] = {
    'LTO5.library_manager':{'adminpri':{2: {'host':'gccensrv+',
                                             'work':'write_to_hsm',
                                             },
                                         }
                             },
    }

configdict['discipline'] = {
    'diskSF.library_manager':{1:{'host':"[A-Za-z]+",
                                 'function':'restrict_host_access',
                                 'args':["[A-Za-z]",3],
                                 'action':'ignore'},
                              },
    }


configdict['blocksizes'] = { 'LTO3'      : 131072,
			     'LTO4'      : 131072,
			     'null'      : 131072,
			     '9940B'     : 131072,
                             'LTO5'      : 1 * MB,
                             'diskfile'  : 256*KB,
			   }

configdict['wrappersizes'] = { 'null' : (100L*GB) - 1,
			       'cern' : long("9"*20),
			       'cpio_odc' : (8L*GB) - 1,
                               }

# The old (and duplicated) db_host and db_port are for backward
# compatibility. Eventually, all should switch to dbhost and dbport
configdict['database'] = {
    'db_dir': '%s/enstore-database' % (db_basedir,),
    'jou_dir': '%s/enstore-journal' % (db_basedir,),
    'db_host': DB_host,
    'db_port': 9999,
    
    'dbhost': DB_host,
    'dbport': 9999,
    'dbname': 'enstoredb',
    'dbuser': 'enstore',
    'dbuser_reader': 'enstore_reader',
    'dbserverowner': 'products',
    'dbarea':'%s/enstore-db' % (db_basedir,),
    }

# operation db
configdict['operation_db'] = {
    'dbhost': DB_host,
    'dbport': 9900,
    'dbname': 'operation',
    'dbuser': 'enstore',
    'dbserverowner': 'products',
    }

configdict['backup'] = {
    # SDE
    'host':backup_host,
    'dir':"%s/enstore-backup" % (backup_dir,),
    'extract_dir':"%s/check-db-tmp" % (backup_dir,),
    'check_db_area':"%s/check-database" % (backup_dir,)
    }

configdict['domains'] = {
    'invalid_domains' : [],
    'valid_domains'   : [],
    }

configdict['crons'] = {
    'www_alias'       : www_alias, #optional
    'pnfs_alias'      : pnfs_alias, #optional
    'web_node'        : monitoring_and_web,
    'html_dir'        : html_dir,
    'log_dir'         : log_dir,
    'tmp_dir'         : "/tmp",
    'email'           : "moibenko@fnal.gov",
    'developer_email' : "moibenko@fnal.gov",
    'backup_node'     : enstore_backup,
    'backup_dir'      : backup_dir,
    'monitored_nodes' : [
			"dmsen05",
			"dmsen02",
			"dmsen03",
			#"stkenmvr132a",
                        ],
    'farmlets_dir'    : "/usr/local/etc/farmlets",
    'url_dir'         : "http://dmsen06.fnal.gov/enstore/",
    'enstore_name'    : "File Aggregation",
    'spool_dir'       : "/srv2/enstore/MigrationSpool", #make_failed_copies
    'backup2tape_dir' : "/pnfs/eagle/gccen-backups/",
    'backup2tape_config_host' : "conf-stken.fnal.gov",
    'copy_ran_file_log_dir'   : "/srv2/enstore_cache/copy_ran_file",
    }

#If the following items match an enstore server's name, then a host
# specified here is not necessary.  It is taken from that servers host
# value.  If it is not a server's name, then you must put a host
# entry here.
configdict['crontabs'] = {
    'log_server'        : {'cronfiles' : ["log_server",
					  "log_html"]},
    'web_server'        : {'cronfiles' : ["enstore_plots",
					  "enstore_html",
					  "inventory.fermi",
					  "inventory_web",
					  "chkcrons",  #What does it do?
					  "tab_flipping",
					  "summary_plots",
					  ],
			   'host'      : monitoring_and_web},
    'verifying'         : {'cronfiles' : ["checkPNFS",
					  "copy_ran_file"],
			   'host'      : verify_host},
    'pnfs'              : {'cronfiles' : ["delfile",
					  "pnfs_misc"],
			   'host'      : enstore_pnfs},
    'accounting_server' : {'cronfiles' : ["accounting_db"]},
    'drivestat_server'  : {'cronfiles' : ["drivestat_db"]},
    'file_clerk'        : {'cronfiles' : ["enstore_db"]},
    'databases'         : {'cronfiles' : ["checkdb",
					  "backup",
					  "backup2Tape",
					  "inventory"],
			   'host'      : enstore_backup},
    }


configdict['inventory'] = {
    'inventory_dir'		: inventory_dir,
    'inventory_tmp_dir'		: "%s/tmp" % (inventory_dir,),
    'inventory_cache_dir'	: "%s_cache" % (inventory_dir,),
    'inventory_extract_dir'	: "%s/extract" % (inventory_dir,),
    'inventory_rcp_dir'	        : '%s:%s/tape_inventory' % (monitoring_and_web, html_dir,),
    'wpa_states'		: ["full", "readonly"],
    'wpa_media_types'	        : ["LTO5",],
    'wpa_excluded_libraries'	: ["null1", "disk", "test"],
    }

# tape mount limits according to media type
# when mounts exceed the first number, an alarm should be generated
# when it exceeds the second number, enstore ball should be turned red
#
# ignore any media type that is not mentioned
configdict['tape_mount_limit'] = {
	'LTO3' : (5000, 10000),
	'LTO4' : (5000, 10000),
	'LTO5' : (5000, 10000),
	}

configdict['extra_links'] = {
    }

#configdict['pnfs_server'] = {'host':enstore_pnfs,}  # uncomment this when the new config server is deployed
#configdict ['pnfs_agent'] = {'host': enstore_pnfs, 'port': 7517, 'max_threads':40}

configdict['pnfs_agent'] = {
    'host':'dmsen06.fnal.gov',
    'port':7517,
    'logname':'PNFSAGENT',
    'norestart':'INQ',
    'max_threads':100,
    }

configdict['web_server'] = {
    'ServerHost'     : web_server_host,
    'port'           : 80,
    'User'           : 'enstore',
    'Group'          : 'enstore',
    'ServerName'     : 'dmsen02.fnal.gov',
    'DocumentRoot'   : "%s/html" % (httpd_dir2,),
    'ScoreBoardFile' : "%s/apache_status" % (httpd_dir,),
    'PidFile'   : "%s/httpd.pid" % (httpd_dir,),
    'ErrorLog'  : "%s/error.log" % (httpd_dir,),
    'CustomLog' : { 'combined' : "%s/access.log" % (httpd_dir,),
		    'referer'  : "%s/referer.log" % (httpd_dir,),
		    'agent'    : "%s/agent.log" % (httpd_dir,),
		    },
    'ServerRoot' : '/etc/httpd' ,
    'ScriptAlias' : {'fake' : '/cgi-bin/',
		     'real' : "%s/cgi-bin/" % (httpd_dir2,),
		     }
    }

configdict['www_server'] = {
    'system_tag' : "File Aggregation Test System",
    'media' : {'1' : 'GCC SL8500',
	       },
    'inq_ignore' : 1,
    }
#########################################################################
# File Aggregation Servers (Components)
#########################################################################

#########################################################################
# Migratoin Dispatcher(s)
#########################################################################
# This configuration may get eventually a part of Policy Engine server
# but for now define it here to get configuration of queues for migrators
configdict['Primary.migration_dispatcher'] = {
    'queue_work': 'migrator',
    'queue_reply': 'migrator_reply',
    }
    
#########################################################################
# Migrators
#########################################################################
configdict['M1.migrator'] = {
    #'host':'dmsen02.fnal.gov',
    'host':'enmvr007',
    'port': 5610,
    'logmname': "M1MG",
    'migration_dispatcher': 'GCC.migration_dispatcher',
    'data_area': write_cache_area,
    'archive_area': archive_area,
    'stage_area': stage_area,
    'tmp_stage_area': tmp_stage_area,
    'norestart':'INQ',
    'migration_dispatcher':'dispatcher', 
    'dismount_delay': 2,
    'check_written_file': 1,
    }
configdict['M2.migrator'] = {
    #'host':'dmsen03.fnal.gov',
    'host':'enmvr007',
    'port': 5611,
    'logmname': "M2MG",
    'migration_dispatcher': 'GCC.migration_dispatcher',
    'data_area': write_cache_area,
    'archive_area': archive_area,
    'stage_area': stage_area,
    'tmp_stage_area': tmp_stage_area,
    'norestart':'INQ',
    'migration_dispatcher':'dispatcher', 
    'dismount_delay': 2,
    }

configdict['M3.migrator'] = {
    #'host':'dmsen03.fnal.gov',
    'host':'enmvr008',
    'port': 5612,
    'logmname': "M3MG",
    'migration_dispatcher': 'GCC.migration_dispatcher',
    'data_area': write_cache_area,
    'archive_area': archive_area,
    'stage_area': stage_area,
    'tmp_stage_area': tmp_stage_area,
    'norestart':'INQ',
    'migration_dispatcher':'dispatcher', 
    'dismount_delay': 2,
    }
configdict['M4.migrator'] = {
    #'host':'dmsen03.fnal.gov',
    'host':'enmvr008',
    'port': 5614,
    'logmname': "M4MG",
    'migration_dispatcher': 'GCC.migration_dispatcher',
    'data_area': write_cache_area,
    'archive_area': archive_area,
    'stage_area': stage_area,
    'tmp_stage_area': tmp_stage_area,
    'norestart':'INQ',
    'migration_dispatcher':'dispatcher', 
    'dismount_delay': 2,
    }

    
#########################################################################
# AMQP - this is in test phase
#########################################################################
configdict['amqp_broker'] = {
    'host':enstore_qpid_broker_host,
    'port':5672,
    }

configdict['lmd.udp_proxy_server'] = { # udp to amq proxy server
    'norestart':'INQ',
    #'host': 'dmsen06.fnal.gov',
    'host': 'pmig01.fnal.gov',
    'port': 5601,
    'udp_port' : 7710,
    'target_addr':'udp_relay_test',
    }
    
configdict['lm_director'] = {
    'norestart':'INQ',
    #'host': 'dmsen02.fnal.gov',
    'host': 'pmig01.fnal.gov',
    'port': 5602,
    'udp_port' :5602,
    'logname':'LMDSRV',
    'queue_in': 'udp_relay_test',
    'udp_proxy_server': 'lmd.udp_proxy_server',
    'policy_file': "/home/enstore/policy_files/lmd_policy.py"
    }

configdict['dispatcher'] = {
    'norestart':'INQ',
    #'host': 'dmsen02.fnal.gov',
    'host': 'pmig01.fnal.gov',
    'port': 5603,
    'logname':'DISP',
    'queue_work': 'policy_engine',
    'queue_reply': 'file_clerk',
    'migrator_work': 'migrator',
    'migrator_reply': 'migrator_reply',
    'policy_file': "/home/enstore/policy_files/lmd_policy.py",
    'max_time_in_cache': 600,
    'purge_watermarks':(.8, .4),
    }

#########################################################################
# The following items describe Enstore Servers.
#########################################################################

configdict['event_relay'] = {
    'host':event_relay_host,
    'port':55510,
    }

configdict['file_clerk'] = {
    'host':file_clerk_host,
    'port':7701,
    'logname':'FILSRV',
    'norestart':'INQ',
    'brand':'GCMS',
    }

configdict['volume_clerk'] = {
    'host':volume_clerk_host,
    'port':7702,
    'logname':'VOLSRV',
    'norestart':'INQ',
    'max_noaccess_cnt' : vol_max_noaccess_cnt,
    }

configdict['alarm_server'] = {
    'host':alarm_server_host,
    'port':7503,
    'logname':'ALMSRV',
    'norestart':'INQ',
    }

configdict['log_server'] = {
    'host':log_server_host,
    'port':7504,
    'norestart':'INQ',
    'msg_type_logs': {'MSG_TYPE=MC_LOAD_REQ' : 'MOUNTS-',
		      'MSG_TYPE=MC_LOAD_DONE' : 'MOUNTS-',
		      'MSG_TYPE=ENCP_XFER' : 'ENCPS-',
		      'MSG_TYPE=EVENT_RELAY' : 'EVRLY-',
		      'MSG_TYPE=ADD_TO_LMQ' : 'LMQADDS-'},
    'log_file_path' : log_dir,
    }

configdict['info_server'] = {
    'host': info_server_host,
    'port': 7677,
    'logname': 'INFSRV',
    'norestart':'INQ',
    'dbhost': DB_host,
    'dbname': 'enstoredb',
    }

configdict['accounting_server'] = {
    'host': accounting_server_host,
    'port': 7780,
    'logname': 'ACCSRV',
    'norestart':'INQ',
    'dbhost': DB_host,
    'dbport': 9900,
    'dbname': 'accounting',
    'dbuser': 'enstore',
    'dbuser_reader': 'enstore_reader',
    'dbserverowner': 'products',
    'dbarea': '%s/accounting-db' % (db_basedir,),
    }

configdict['drivestat_server'] = {
    'host': drivestat_server_host,
    'port': 7790,
    'logname': 'DRSSRV',
    'norestart':'INQ',
    'dbhost': DB_host,
    'dbport': 9902,
    'dbname': 'drivestat',
    'dbuser': 'enstore',
    'dbuser_reader': 'enstore_reader',
    'dbserverowner': 'products',
    'dbarea': '%s/drivestat-db' % (db_basedir,),
    }

configdict['ratekeeper'] = {
    'host'		: ratekeeper_host,	#node ratekeeper is running on
    'port'		: 7506,		#port ratekeeper is running on
    'norestart'		: 'INQ',
    'noupdown'		: 'efb',
    'logname'		: 'RATSRV',		#logname
    ### The following 5 items can be removed when confidence is high that
    ### the rate information is going into the accounting DB.
    'dir'		: ratekeeper_dir,	#directory to write rates to
    'tmp'		: "%s/tmp/" % (ratekeeper_dir,), #temp directory used
    'ps'		: '%s/*rates.ps' % (html_dir,),
    'jpg'		: '%s/*rates.jpg' % (html_dir,),
    'stamp'		: '%s/*rates_stamp.jpg' % (html_dir,),
    }

configdict['inquisitor'] = {
    'host':inquisitor_host,
    'port':7505,
    'logname':'INQSRV',
    'alive_rcv_timeout': 15,
    'alive_retries':1,
    'refresh' : 3600,
    'html_file':html_dir,
    'http_log_file_path':'/enstore/log/',
    'www_host':'http://%s' % (inquisitor_host,),
    'max_encp_lines': 250,
    'user_log_dirs' : {'File Aggr. Cluster Node Info'	: '/enstore/nodeinfo.html',
		       #'File Aggr.Cluster Console Logs'	: '/enstore/CONSOLES.html',
		       #'File Aggr. Cluster SDR Info'	: '/enstore/SDR.html',
		       #'File Aggr. Cluster SEL Info'	: '/enstore/SEL.html',
		       #'File Aggr. Internode Rates'		: '/enstore/quickcheck.eepro100.html',
		       #'File Aggr. UDP Clogup Info'		: '/enstore/UDPclog.html',
		       'File Aggr. Tape Drives'		: '/enstore/firmware_stat_report.html',
		       'Active Monitor Log'		: '/enstore/active_monitor.html',
		       'Network-At-A-Glance'		: '/enstore/enstore_saag_network.html',
		       'File Aggr. PNFS Export List'         : '/enstore/%s_pnfsExports.html' % (inquisitor_host,),
		       'FAILED Transfers'		: '/enstore/transfer_failed.txt ',
		       #'Recent STK log messages'	: '/enstore/log/STK-log ',
		       'Recent SL8500 log messages'     : '/enstore/log/SL8500-log',
		       'File Aggr. PNFS monitor report'	: '/enstore/%s_pnfs_monitor' % (inquisitor_host,),
		       },
    'default_alive_interval': 40,
    'default_hung_interval' : 120,
    }

configdict['monitor_server'] = {
    'html_dir'		: html_dir,
    'html_gen_host'	: web_server_host,
    'refresh'		: 3600,
    'block_size'	: 65536,
    'block_count'	: 160,
    'default_timeout'	: 3,
    }

configdict['null.library_manager']     =  {
    'host':library_manager_host,
    #'host':'dmsen06.fnal.gov',
    'port':7511,
    'mover_port': 7712,
    'encp_port':7713,
    'logname':'NULLBM',
    'norestart':'INQ',
    'noupdown':'jon',
    #'inq_ignore':'jon',
    'max_encp_retries':3,
    'max_file_size':(8L*GB) - 1,
    'suspect_volume_expiration_time':24*3600,
    'legal_encp_version':legal_encp_version,
    #'max_requests':50000,
    'max_requests':25000,
    #'allow': {'NULL00':['gccensrv*'],
    #},
    #'lock': 'pause',
    'restrict_access_in_bound': True,
    'use_raw_input': 1,
    'use_threads':False,
    #'use_threads':True,
    #'lock':'nowrite',
    }

"""
configdict['LTO5.library_manager']      =  {
    'host':library_manager_host,
    #'host':'gccensrv2',
    'port':7515,
    'logname':'LTO5LM',
    'norestart':'INQ',
    #'noupdown':'AM',
    #'inq_ignore': 'AM',
    'max_encp_retries':3,
    'max_suspect_movers':3,
    'max_file_size':(1500L*GB) - 1,
    'min_file_size':300*MB,
    'suspect_volume_expiration_time':3600*24,
    'legal_encp_version':legal_encp_version,
    'storage_group_limits':{'ENDEV' : 15,
			    },
    'CleanTapeVolumeFamily': 'CLEAN.CleanTapeFileFamily.noWrapper',
    'blank_error_increment':blank_error_increment,
    'use_LMD': 'lmd.udp_proxy_server',
    'mover_port': 7560,
    'encp_port':7561,
    'use_raw_input': 1,
    'use_threads':False,
    
    }

configdict['LTO5_02.mover'] = {
    'host':'enmvr002',
    'data_ip':'enmvr002',
    'port':7802,
    'logname':'LTO5_02MV',
    'statistics_path':'/tmp/enstore/enstore/LTO5_02.stat',
    'norestart':'INQ',
    #'noupdown':'INQ',
    #'inq_ignore' : 'INQ',
    'max_consecutive_failures': mvr_max_consecutive_failures,
    'max_failures': mvr_max_failures,
    'compression':0,
    #'check_written_file': lto4_mvr_check_f,
    #'check_first_written_file':lto4_mvr_check_1st,
    'min_buffer':lto5_min_buffer,
    'max_buffer':lto5_max_buffer,
    'max_rate': lto5_rate,
    'mount_delay':15,
    'update_interval':lto5_update_interval,
    'update_interval_in_bound' : update_interval_in_bound,
    'library':'LTO5.library_manager',
    'device':'/dev/rmt/tps6d0n',
    'driver':'FTTDriver',
    'mc_device':'2,0,1,2',
    'media_changer':'SL8500GS.media_changer',
    'do_cleaning':'No',
    'syslog_entry':low_level_diag_pattern,
    'max_time_in_state':1200,
    'send_stats':1,
    'dismount_delay': lto5_dismount_delay,
    'single_filemark': 1,
    }
"""

configdict['LTO3GS.library_manager'] = {
    'host':library_manager_host,
    #'host':'cmswn699',
    'port':8544,
    'logname':'LTO3GSLM',
    'norestart':'INQ',
    'max_encp_retries':3,
    'max_suspect_movers':3,
    'max_file_size':(400L*GB) - 1,
    'min_file_size':300*MB,
    'suspect_volume_expiration_time':3600*24,
    #'max_requests':15000,
    'max_requests':30000,
    'legal_encp_version':legal_encp_version,
    'CleanTapeVolumeFamily': 'CLEAN.CleanTapeFileFamily.noWrapper',
    'blank_error_increment':blank_error_increment,
    'restrict_access_in_bound': True,
    ### additional fields for new library manager
    ## remove them to back out to the old library manager
    'mover_port': 7014,
    'encp_port':7015,
    'use_raw_input': 1,
    'use_threads':False,
    'use_LMD': 'lmd.udp_proxy_server',
    #'use_LMD': 'lm_director',
    }

configdict['LTO3_037.mover'] = {
    'host':'enmvr037',
    'data_ip':'enmvr037',
    'port':7893,
    'logname':'LTO3_037MV',
    'statistics_path':'/tmp/enstore/enstore/LTO3_037.stat',
    'norestart':'INQ',
    'max_consecutive_failures': mvr_max_consecutive_failures,
    'max_failures': mvr_max_failures,
    'compression':0,
    'check_written_file': lto3_mvr_check_f,
    'check_first_written_file':lto3_mvr_check_1st,
    'min_buffer':lto3_min_buffer,
    'max_buffer':lto3_max_buffer,
    'max_rate': lto3_rate,
    'mount_delay':15,
    'update_interval':5,
    'update_interval_in_bound':  update_interval_in_bound,
    'library':'LTO3GS.library_manager',
    'device':'/dev/rmt/tps2d0n',
    'driver':'FTTDriver',
    'mc_device':'2,2,1,9',
    'media_changer':'SL8500GS.media_changer',
    'do_cleaning':'No',
    'syslog_entry':low_level_diag_pattern,
    'max_time_in_state':1200,
    'send_stats':1,
    'dismount_delay': lto3_dismount_delay,
    }

configdict['LTO3_038.mover'] = {
    'host':'enmvr038',
    'data_ip':'enmvr038',
    'port':7894,
    'logname':'LTO3_038MV',
    'statistics_path':'/tmp/enstore/enstore/LTO3_038.stat',
    'norestart':'INQ',
    'max_consecutive_failures': mvr_max_consecutive_failures,
    'max_failures': mvr_max_failures,
    'compression':0,
    'check_written_file': lto3_mvr_check_f,
    'check_first_written_file':lto3_mvr_check_1st,
    'min_buffer':lto3_min_buffer,
    'max_buffer':lto3_max_buffer,
    'max_rate': lto3_rate,
    'mount_delay':15,
    'update_interval':5,
    'update_interval_in_bound':  update_interval_in_bound,
    'library':'LTO3GS.library_manager',
    'device':'/dev/rmt/tps2d0n',
    'driver':'FTTDriver',
    'mc_device':'2,3,1,11',
    'media_changer':'SL8500GS.media_changer',
    'do_cleaning':'No',
    'syslog_entry':low_level_diag_pattern,
    'max_time_in_state':1200,
    'send_stats':1,
    'dismount_delay': lto3_dismount_delay,
    }

configdict['LTO3_039.mover'] = {
    'host':'enmvr039',
    'data_ip':'enmvr039',
    'port':7895,
    'logname':'LTO3_039MV',
    'statistics_path':'/tmp/enstore/enstore/LTO3_039.stat',
    'norestart':'INQ',
    'max_consecutive_failures': mvr_max_consecutive_failures,
    'max_failures': mvr_max_failures,
    'compression':0,
    'check_written_file': lto3_mvr_check_f,
    'check_first_written_file':lto3_mvr_check_1st,
    'min_buffer':lto3_min_buffer,
    'max_buffer':lto3_max_buffer,
    'max_rate': lto3_rate,
    'mount_delay':15,
    'update_interval':5,
    'update_interval_in_bound':  update_interval_in_bound,
    'library':'LTO3GS.library_manager',
    'device':'/dev/rmt/tps2d0n',
    'driver':'FTTDriver',
    'mc_device':'2,2,1,5',
    'media_changer':'SL8500GS.media_changer',
    'do_cleaning':'No',
    'syslog_entry':low_level_diag_pattern,
    'max_time_in_state':1200,
    'send_stats':1,
    'dismount_delay': lto3_dismount_delay,
    }
"""
configdict['LTO3_040.mover'] = {
    'host':'enmvr040',
    'data_ip':'enmvr040',
    'port':7896,
    'logname':'LTO3_040MV',
    'statistics_path':'/tmp/enstore/enstore/LTO3_040.stat',
    'norestart':'INQ',
    'max_consecutive_failures': mvr_max_consecutive_failures,
    'max_failures': mvr_max_failures,
    'compression':0,
    'check_written_file': lto3_mvr_check_f,
    'check_first_written_file':lto3_mvr_check_1st,
    'min_buffer':lto3_min_buffer,
    'max_buffer':lto3_max_buffer,
    'max_rate': lto3_rate,
    'mount_delay':15,
    'update_interval':5,
    'update_interval_in_bound':  update_interval_in_bound,
    'library':'LTO3GS.library_manager',
    'device':'/dev/rmt/tps2d0n',
    'driver':'FTTDriver',
    'mc_device':'2,3,1,7',
    'media_changer':'SL8500GS.media_changer',
    'do_cleaning':'No',
    'syslog_entry':low_level_diag_pattern,
    'max_time_in_state':1200,
    'send_stats':1,
    'dismount_delay': 60,
    }
"""

configdict['SL8500GS.media_changer'] = {
    'host':media_changer_host,
    'port':8503,
    'logname':'SL8500GSMC',
    'type':'STK_MediaLoader',
    'norestart':'INQ',
    'max_work':3,
    'acls_host':'fntt',
    'acls_uname':'acsss',
    'DriveCleanTime':{'LTO3':[60,1],
                      'LTO4':[60,1],
                      'LTO5':[60,1],
                      },
    'tape_library':"GCC Standalone StreamLine 8500",
    }



configdict['null.media_changer'] = {
    'host':media_changer_host,
    'port':7520,
    'logname':'NUL1MC',
    'type':'RDD_MediaLoader',
    'norestart':'INQ',
    'noupdown':'jon',
    'inq_ignore':'jon',
    }


configdict['SL8500.media_changer'] = {
    'host':media_changer_host,
    'port':7523,
    'logname':'SL8500MC ',
    'type':'STK_MediaLoader',
    'norestart':'INQ',
    'max_work':1,	# for tests make sure it is less than number of drives	
    'acls_host':'fntt-gcc',
    'acls_uname':'acsss',
    'DriveCleanTime':{'LTO3':[60,1],
		      'LTO4':[60,1],
		      },
    'tape_library':"SL8500 at GCC",
    }

configdict['null01.mover'] = {
    'host':media_changer_host,
    'data_ip':media_changer_host,
    'port':7538,
    'logname':'NUL01MV',
    'norestart':'INQ',
    'noupdown':'efb',
    #'inq_ignore' : 'jon',
    'max_buffer':100*MB,
    'library':'null.library_manager',
    'device':'/dev/null',
    'driver':'NullDriver',
    'mc_device':'-1',
    'media_changer':'null.media_changer',
    'update_interval':2,
    'max_dismount_delay':30,
    'dismount_delay':10,
    
    }
configdict['null02.mover'] = {
    'host':media_changer_host,
    'data_ip':media_changer_host,
    'port':7539,
    'logname':'NUL02MV',
    'norestart':'INQ',
    'noupdown':'efb',
    #'inq_ignore' : 'jon',
    'max_buffer':100*MB,
    'library':'null.library_manager',
    'device':'/dev/null',
    'driver':'NullDriver',
    'mc_device':'-1',
    'media_changer':'null.media_changer',
    'update_interval':2,
    'max_dismount_delay':30,
    'dismount_delay':10,
    }


configdict['diskSF.library_manager'] = {
   #'host':'dmsen06',
   'host':library_manager_host,
   'port':7513,
   'logname':'DISKSFLM',
   'norestart':'INQ',
   'compression':0,
   'max_file_size':(2L*GB) - 1,
    'mover_port': 7570,
    'encp_port':7571,
    'use_raw_input': 1,
    'use_threads':False,
   }


configdict['disk1.mover'] = {
   'device':write_cache_area, # This is a common cache area for all disk movers sharing cache
   #'tmp_dir':'/data/cache/data/tmp',  # This is a temporary place for written files
   'tmp_dir':'%s/tmp'%(write_cache_area,),  # This is a temporary place for written files
   'type':'DiskMover',
   'host':'enmvr005',
   'ip_map':'common', #disk mover only
   'port':7531,
   'library':['diskSF.library_manager',] ,
   'driver':'DiskDriver',
   'mc_device':'1',
   'logname':'DSK1MV',
   'max_buffer':300*MB,
   'update_interval':5,
   'max_time_in_state':300,
   }

configdict['disk2.mover'] = {
   'device':write_cache_area, # This is a common cache area for all disk movers sharing cache
   #'tmp_dir':'/data/cache/data/tmp',  # This is a temporary place for written files
   'tmp_dir':'%s/tmp'%(write_cache_area,),  # This is a temporary place for written files
   'type':'DiskMover',
   #'host':'dmsen06',
   'host':'enmvr005',
   'ip_map':'common', #disk mover only
   'port':7532,
   'library':['diskSF.library_manager',] ,
   'driver':'DiskDriver',
   'mc_device':'1',
   'logname':'DSK2MV',
   'update_interval':5,
   'max_time_in_state':300,
   }

configdict['disk3.mover'] = {
   'device':write_cache_area, # This is a common cache area for all disk movers sharing cache
   #'tmp_dir':'/data/cache/data/tmp',  # This is a temporary place for written files
   'tmp_dir':'%s/tmp'%(write_cache_area,),  # This is a temporary place for written files
   'type':'DiskMover',
   #'host':'dmsen06',
   'host':'enmvr006',
   'ip_map':'common', #disk mover only
   'port':7533,
   'library':['diskSF.library_manager',] ,
   'driver':'DiskDriver',
   'mc_device':'1',
   'logname':'DSK3MV',
   'update_interval':5,
   'max_time_in_state':300,
   }

configdict['disk4.mover'] = {
   'device':write_cache_area, # This is a common cache area for all disk movers sharing cache
   #'tmp_dir':'/data/cache/data/tmp',  # This is a temporary place for written files
   'tmp_dir':'%s/tmp'%(write_cache_area,),  # This is a temporary place for written files
   'type':'DiskMover',
   'host':'enmvr006',
   #'host':library_manager_host,
   'ip_map':'common', #disk mover only
   'port':7534,
   'library':['diskSF.library_manager',] ,
   'driver':'DiskDriver',
   'mc_device':'1',
   'logname':'DSK4MV',
   'update_interval':5,
   'max_time_in_state':300,
   'norestart':'INQ',
   }
"""
configdict['disk5.mover'] = {
   'device':write_cache_area, # This is a common cache area for all disk movers sharing cache
   #'tmp_dir':'/data/cache/data/tmp',  # This is a temporary place for written files
   'tmp_dir':'%s/tmp'%(write_cache_area,),  # This is a temporary place for written files
   'type':'DiskMover',
   'host':'pmig02',
   #'host':library_manager_host,
   'ip_map':'common', #disk mover only
   'port':7534,
   'library':['diskSF.library_manager',] ,
   'driver':'DiskDriver',
   'mc_device':'1',
   'logname':'DSK5MV',
   'update_interval':5,
   'max_time_in_state':300,
   'norestart':'INQ',
   }

configdict['disk6.mover'] = {
   'device':write_cache_area, # This is a common cache area for all disk movers sharing cache
   #'tmp_dir':'/data/cache/data/tmp',  # This is a temporary place for written files
   'tmp_dir':'%s/tmp'%(write_cache_area,),  # This is a temporary place for written files
   'type':'DiskMover',
   'host':'pmig02',
   #'host':library_manager_host,
   'ip_map':'common', #disk mover only
   'port':7535,
   'library':['diskSF.library_manager',] ,
   'driver':'DiskDriver',
   'mc_device':'1',
   'logname':'DSK6MV',
   'update_interval':5,
   'max_time_in_state':300,
   'norestart':'INQ',
   }
"""


"""
priority: OPTIONAL. If present specifies the request priority settings for a
Library Manager based on the ticket keys and regular expressions. For details
please contact developer or look in the priority.py code.

----------------------------------------------------------------
discipline: OPTIONAL. If present specifies the restictions set for the request
for a Library Manager based on the ticket keys and regular expressions. For
details please contact developer or look in the discipline.py code.

----------------------------------------------------------------
LIBRARY MANAGER KEYS

host (string) REQUIRED

port (int) REQUIRED

logname (string) OPTIONAL - defaults to mover name

startup_delay: (int) OPTIONAL Time during which LM ignores mover requests after startup.
	       Default 32

min_file_size: (int or long) OPTIONAL. Minimal file size when requesting volume clerk for
	       the volume to write to. Default 0L

max_file_size: (int or long) OPTIONAL. Maximal file size allowed for the media served by
	       this LM. Default 2*GB - 2*KB

legal_encp_version: (string) OPTIONAL. the oldest allowed encp version. All others will be rejected.
		    Default ''

suspect_volume_expiration_time: (int) OPTIONAL. Time after which becomes cleared.
				Default None

rq_wait_time: (int) OPTIONAL. Recreate postponed request list after this time expires.
	      Default 3600 s

CleanTapeVolumeFamily: (string) OPTIONAL volume family for the cleaning tape. Used by Media Changer.
		       No default

storage_group_limits: minimal amount of drives that can be used by a certain storage group (fair share)
		      when different storage groups compete for tape drives.

-------------------------------------------------------------------

MOVER KEYS

These are all the keys that the mover cares about:

host (string) REQUIRED

port (int) REQUIRED

logname (string) OPTIONAL - defaults to mover name

do_eject (string) OPTIONAL - defaults to 'yes', override by setting
		  "no" or "No" (or anything starting with N or n)

do_cleaning (string) OPTIONAL - defaults to 'yes', override by setting
		     "no" or "No" (or anything starting with N or n)
		     This only controls automatic cleaning.  enstore mov --clean-drive
		     will always work, whether this is set or not.

mc_device (string) not needed for NULL movers; required otherwise

min_buffer (int)  OPTIONAL minimum amount of memory to allocate for
		  buffering - defaults to 8MB

max_buffer (int)  OPTIONAL maximum amount of memory to allocate for
		  buffering - defaults to 64MB

max_rate (float) OPTIONAL maximum sustained transfer rate for writes
		 This is used to calculate optimal buffer size.  It does not need to
		 be exact.

device (string) REQUIRED pathname to the UNIX tape device
		for NULL movers make this /dev/null

dismount_delay (int) OPTIONAL delayed dismount value to use when none
		     specified by the client. Default is 60 seconds.
		     Set to negative value to get "infinite" dismount
		     delay.

mount_delay (int) OPTIONAL number of seconds to wait after media
		  changer mount completes, before trying to open
		  device. Default is 15 for FTT driver, 0 for NULL
		  driver

max_dismount_delay: (int s) OPTIONAL maximal dismount delay that can be set for this mover.
			    Default 600 seconds

library (string or list):  REQUIRED.  Who are we working for?  One or
			   more library manager names.

driver (string): REQUIRED.  Currently must be 'FTTDriver' or
		 'NullDriver', or else mover will complain at startup.
		 If we need a disk mover, this would be easy to hack
		 together; doesn't seem too useful though.

max_consecutive_failures: type int, default 2
			  Mover will declare itself "broken" if this
			  many successive transfers fail, and the
			  error was not ENCP_GONE

max_failures: type int, default 3
	      Mover will declare itself "broken" if this many
	      transfers fail within failure_interval (see below).
	      Again, ENCP_GONE errors do not count

failure_interval: type int, default 3600 (one hour)
		  Interval for above.

send_stats: OPTIONAL if present (can be set to 1) send drive statistics to the drivestat Data Base

type: (string) OPTIONAL type of the mover ('','Mover','DiskMover') specifies the type of mover

ip_map: (string) OPTIONAL ip map of the mover node. Used only in Disk Mover to create a volume name

media_type: (string) OPTIONAL media type used for the mover

log_state: (int) OPTIONAL if set log the state of the mover processes

syslog_entry: (string) OPTIONAL expression to match in the syslog for the low level failure diagnostics

restart_on_error: (int) restart mover if it went to the ERROR state. Default - not restart

connect_timeout (sec) TO for mover connection to encp. Default - 15 s

connect_retries (int) number of connect retries. Default 4

update_interval: (int s) OPTIONAL interval for the mover to ask LM for the work. Default 15 s

single_filemark: (int) OPTIONAL if not 0 write single file mark. Default 0 - write 2 fm

check_written_file: (int) OPTIONAL if more than 0 randomly check written file using randomization of
			  this number. Default 0 - no check. 1 - check every written file.

max_time_in_state: (int s) OPTIONAL time in state after which alarm will be raised. Default 600 s

max_in_state_cnt: (int) OPTIONAL if this counter expires Mover errors out with Mover stuck message.
			Default 3

statistics_path: (string): OPTIONAL. If specified write the last statistics to the file statistics_path.
			   Default None

compression: (int) OPTIONAL 0 means no compression. Everything else means use the drive compression.
		   Default None - use the drive compression

get_remaining_from_stats (optional) : get remaining bytes info from drive

"""
